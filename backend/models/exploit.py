from db import ExploitID, Language, ExploitStatus
from db import ServiceID, ClientID, UnHashedClientID, FkType, TeamID
from models.client import ClientAddForm
from pydantic import BaseModel, AwareDatetime

###-- Exploit Models --###

class ExploitDTO(BaseModel):
    id: ExploitID
    name: str
    language: Language
    status: ExploitStatus
    last_upadte: AwareDatetime
    created_at: AwareDatetime
    service: FkType[ServiceID]
    created_by: FkType[ClientID]

class ExploitAddForm(BaseModel):
    id: ExploitID
    name: str
    language: Language = Language.other
    status: ExploitStatus = ExploitStatus.disabled
    service: ServiceID
    created_by: UnHashedClientID #Only the real client can associate an exploit to it

class ExploitEditForm(BaseModel):
    name: str|None = None
    language: Language|None = None
    status: ExploitStatus|None = None
    service: ServiceID|None = None
    created_by: UnHashedClientID|None = None #Only the real client can associate an exploit to it
    
class ExploitSubmitForm(BaseModel):
    exploit: ExploitEditForm|None = None
    start_time: AwareDatetime
    end_time: AwareDatetime
    status: ExploitStatus
    error: bytes|None
    executed_by: UnHashedClientID
    target: TeamID
    flags: list[str]
