from db import ExploitID, Language, ExploitStatus
from db import ServiceID, GenericClientID, ClientID, FkType
from pydantic import BaseModel, AwareDatetime

###-- Exploit Models --###

class ExploitDTO(BaseModel):
    id: ExploitID
    name: str
    language: Language
    status: ExploitStatus
    last_upadte: AwareDatetime
    created_at: AwareDatetime
    service: FkType[ServiceID]
    client: GenericClientID

class ExploitAddForm(BaseModel):
    id: ExploitID
    name: str
    language: Language = Language.other
    status: ExploitStatus = ExploitStatus.disabled
    service: ServiceID
    client: ClientID #Only the real client can associate an exploit to it

class ExploitEditForm(BaseModel):
    name: str|None = None
    language: Language|None = None
    status: ExploitStatus|None = None
    service: ServiceID|None = None
    client: ClientID|None = None #Only the real client can associate an exploit to it